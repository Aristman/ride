# üß† –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏

## üìã –û–±–∑–æ—Ä

–ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞ Ride, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å, –∫–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –∑–∞–¥–∞–≤–∞—Ç—å —É—Ç–æ—á–Ω—è—é—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã, –∞ –∫–æ–≥–¥–∞ ‚Äî –¥–∞–≤–∞—Ç—å –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã.

## ‚ú® –ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### üéØ –£–º–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –æ—Ç–≤–µ—Ç–æ–≤ AI –Ω–∞ —É—Ä–æ–≤–µ–Ω—å –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏
- –ü–æ—Ä–æ–≥–æ–≤—ã–π –º–µ—Ö–∞–Ω–∏–∑–º (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 0.1)
- –ê–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–¥ —Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫

### üí≠ –ü–æ–ª–Ω–∞—è –ø–∞–º—è—Ç—å –¥–∏–∞–ª–æ–≥–∞
- –ó–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –≤—Å–µ—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞
- –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏—Å—Ç–æ—Ä–∏–∏
- –†–æ–ª–µ–≤–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π (USER, ASSISTANT, SYSTEM)

### ‚ùì –£—Ç–æ—á–Ω—è—é—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Ç–æ—á–Ω—è—é—â–∏—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ –ø—Ä–∏ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏
- –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –≤–æ–ø—Ä–æ—Å–æ–≤ –∏–∑ —Å–ª–æ–∂–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤
- –í–∏–∑—É–∞–ª—å–Ω–∞—è –∏–Ω–¥–∏–∫–∞—Ü–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —É—Ç–æ—á–Ω–µ–Ω–∏—è

### üé® –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ UI –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
- –§–ª–∞–≥ `isFinal` –¥–ª—è —Ä–∞–∑–ª–∏—á–µ–Ω–∏—è —Ç–∏–ø–æ–≤ –æ—Ç–≤–µ—Ç–æ–≤
- –£—Ä–æ–≤–µ–Ω—å –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏ `uncertainty` (0.0 - 1.0)
- –ò–∑–≤–ª–µ—á–µ–Ω–Ω—ã–µ —É—Ç–æ—á–Ω—è—é—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–¥–µ
```kotlin
val agent = AgentFactory.createChatAgent()
val response = agent.processRequest("–ö–∞–∫ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥?", context)

// –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–∞ –æ—Ç–≤–µ—Ç–∞
if (response.isFinal) {
    // ‚úÖ –û–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç —Å –≤—ã—Å–æ–∫–æ–π —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å—é
    showFinalAnswer(response.content)
} else {
    // ‚ùì –¢—Ä–µ–±—É—é—Ç—Å—è —É—Ç–æ—á–Ω–µ–Ω–∏—è
    val uncertainty = response.uncertainty // 0.0 - 1.0
    val questions = UncertaintyAnalyzer.extractClarifyingQuestions(response.content)
    showClarifyingQuestions(questions, uncertainty)
}
```

### –ê–Ω–∞–ª–∏–∑ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏
```kotlin
// –ü—Ä—è–º–æ–π –∞–Ω–∞–ª–∏–∑ —Ç–µ–∫—Å—Ç–∞
val text = "–Ø –Ω–µ —É–≤–µ—Ä–µ–Ω, —á—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø–æ–Ω—è–ª –≤–∞—à –≤–æ–ø—Ä–æ—Å"
val uncertainty = UncertaintyAnalyzer.analyzeUncertainty(text, context)
val hasQuestions = UncertaintyAnalyzer.hasExplicitUncertainty(text)
val questions = UncertaintyAnalyzer.extractClarifyingQuestions(text)

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä–æ–≥–∞
val isFinal = UncertaintyAnalyzer.isFinalResponse(uncertainty, threshold = 0.1)
```

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- **UncertaintyAnalyzer** - —è–¥—Ä–æ –∞–Ω–∞–ª–∏–∑–∞ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏
- **ConversationMessage** - —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –¥–∏–∞–ª–æ–≥–∞
- **AgentResponse** - —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã —Å —Ñ–ª–∞–≥–∞–º–∏
- **ChatAgent** - –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –∞–≥–µ–Ω—Ç —Å –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ–π –ª–æ–≥–∏–∫–æ–π

### –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç—ã
1. **–ê–Ω–∞–ª–∏–∑ –∑–∞–ø—Ä–æ—Å–∞** ‚Üí –∫–æ–Ω—Ç–µ–∫—Å—Ç + –∏—Å—Ç–æ—Ä–∏—è –¥–∏–∞–ª–æ–≥–∞
2. **–ó–∞–ø—Ä–æ—Å –∫ LLM** ‚Üí —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç —Å –ø—Ä–∞–≤–∏–ª–∞–º–∏ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏
3. **–ê–Ω–∞–ª–∏–∑ –æ—Ç–≤–µ—Ç–∞** ‚Üí –ø–∞—Ç—Ç–µ—Ä–Ω-–º–∞—Ç—á–∏–Ω–≥, –¥–µ—Ç–µ–∫—Ü–∏—è –≤–æ–ø—Ä–æ—Å–æ–≤, —Ä–∞—Å—á–µ—Ç —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏
4. **–ü—Ä–∏–Ω—è—Ç–∏–µ —Ä–µ—à–µ–Ω–∏—è** ‚Üí –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç vs —É—Ç–æ—á–Ω—è—é—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã
5. **–í–æ–∑–≤—Ä–∞—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞** ‚Üí –∫–æ–Ω—Ç–µ–Ω—Ç + —Ñ–ª–∞–≥–∏ + –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ

## üìä –ú–µ—Ç—Ä–∏–∫–∏ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

### –¢–µ—Å—Ç–æ–≤–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ
- **18 —Ç–µ—Å—Ç–æ–≤** –¥–ª—è –Ω–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
- **100%** –ø—Ä–æ—Ö–æ–¥—è—â–∏—Ö —Ç–µ—Å—Ç–æ–≤
- **12 —Ç–µ—Å—Ç–æ–≤** –¥–ª—è UncertaintyAnalyzer
- **6 —Ç–µ—Å—Ç–æ–≤** –¥–ª—è ChatAgent integration

### –ü–∞—Ç—Ç–µ—Ä–Ω—ã –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏
- –Ø–≤–Ω—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã: "–Ω–µ —É–≤–µ—Ä–µ–Ω", "–Ω—É–∂–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è", "—É—Ç–æ—á–Ω–∏—Ç–µ"
- –í–æ–ø—Ä–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏: –ø–æ–∏—Å–∫ "?" –≤ —Ç–µ–∫—Å—Ç–µ
- –°–ª–æ–≤–∞ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏: "–≤–æ–∑–º–æ–∂–Ω–æ", "–≤–µ—Ä–æ—è—Ç–Ω–æ", "–º–æ–∂–µ—Ç –±—ã—Ç—å"
- –ö–æ—Ä–æ—Ç–∫–∏–µ –æ—Ç–≤–µ—Ç—ã: –ø–æ–≤—ã—à–µ–Ω–Ω–∞—è –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç—å –ø—Ä–∏ –¥–ª–∏–Ω–µ < 50 —Å–∏–º–≤–æ–ª–æ–≤

## üé® UI Integration Guide

### –í–∏–∑—É–∞–ª—å–Ω–æ–µ —Ä–∞–∑–ª–∏—á–∏–µ –æ—Ç–≤–µ—Ç–æ–≤
```kotlin
// –í –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ—Ç–≤–µ—Ç–∞
if (response.isFinal) {
    // –ó–µ–ª–µ–Ω—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä ‚úÖ
    setContentStyle(final = true)
    setUncertaintyIndicator(null)
} else {
    // –ñ–µ–ª—Ç—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä ‚ùì
    setContentStyle(final = false)
    setUncertaintyIndicator(response.uncertainty)
    showClarifyingQuestions()
}
```

### –ò—Å—Ç–æ—Ä–∏—è –¥–∏–∞–ª–æ–≥–∞
```kotlin
// –ò—Å—Ç–æ—Ä–∏—è —Å —Ä–æ–ª–µ–≤—ã–º —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º
conversationHistory.forEach { message ->
    when (message.role) {
        ConversationRole.USER -> displayUserMessage(message.content)
        ConversationRole.ASSISTANT -> displayAssistantMessage(message.content)
        ConversationRole.SYSTEM -> displaySystemMessage(message.content)
    }
}
```

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **[–ü–æ–ª–Ω—ã–π —Ä–æ–∞–¥–º–∞–ø](UNCERTAINTY_ANALYSIS_ROADMAP.md)** - –¥–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ
- **[CLAUDE.md](CLAUDE.md)** - –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞
- **–¢–µ—Å—Ç—ã** - –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ `src/test/kotlin/ru/marslab/ide/ride/agent/`

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ—Ä–æ–≥–∞ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏
```kotlin
// –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é 0.1, –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å
val isFinal = UncertaintyAnalyzer.isFinalResponse(uncertainty, threshold = 0.2)
```

### –°–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç
–ü—Ä–∞–≤–∏–ª–∞ –æ—Ü–µ–Ω–∫–∏ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏ –≤—Å—Ç—Ä–æ–µ–Ω—ã –≤ —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç ChatAgent:
```
–ü–†–ê–í–ò–õ–û –û–¶–ï–ù–ö–ò –ù–ï–û–ü–†–ï–î–ï–õ–ï–ù–ù–û–°–¢–ò:
–ï—Å–ª–∏ —Ç–≤–æ—è –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç—å –±–æ–ª—å—à–µ 0.1 - –ó–ê–î–ê–í–ê–ô –£–¢–û–ß–ù–Ø–Æ–©–ò–ï –í–û–ü–†–û–°–´
–ï—Å–ª–∏ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç—å 0.1 –∏–ª–∏ –º–µ–Ω—å—à–µ - –¥–∞–≤–∞–π –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç
```

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

### ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
- –ü–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è –¥–∏–∞–ª–æ–≥–∞ —Å —Ä–æ–ª—è–º–∏
- –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —É—Ç–æ—á–Ω—è—é—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã
- –ì–æ—Ç–æ–≤—ã–π API –¥–ª—è UI –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
- –ö–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### üîÑ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏
- –í–∏–∑—É–∞–ª—å–Ω–æ–µ —Ä–∞–∑–ª–∏—á–∏–µ –æ—Ç–≤–µ—Ç–æ–≤ –≤ UI
- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏
- –°–±–æ—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ—Ä–æ–≥–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ñ–∏–¥–±–µ–∫–∞

---

**–§–∏—á–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å! üöÄ**