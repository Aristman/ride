# –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞–º–∏ –∏ —Å–∂–∞—Ç–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

## –°—Ç–∞—Ç—É—Å
‚úÖ **–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ** (v1.0)

## –û–±–∑–æ—Ä
–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞–º–∏ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –¥–∏–∞–ª–æ–≥–∞ —Å LLM. –í–∫–ª—é—á–∞–µ—Ç –ø–æ–¥—Å—á—ë—Ç —Ç–æ–∫–µ–Ω–æ–≤, –ø—Ä–æ–≤–µ—Ä–∫—É –ª–∏–º–∏—Ç–æ–≤ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–∂–∞—Ç–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏.

## –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### 1. TokenCounter
–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –ø–æ–¥—Å—á—ë—Ç–∞ —Ç–æ–∫–µ–Ω–æ–≤ –≤ —Ç–µ–∫—Å—Ç–µ.

```kotlin
interface TokenCounter {
    fun countTokens(text: String): Int
    fun countTokens(messages: List<ConversationMessage>): Int
    fun countRequestTokens(
        systemPrompt: String,
        userMessage: String,
        conversationHistory: List<ConversationMessage>
    ): Int
}
```

**–†–µ–∞–ª–∏–∑–∞—Ü–∏–∏:**
- `TiktokenCounter` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫—É jtokkit (OpenAI —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä)
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–Ω—ã—Ö –∫–æ–¥–∏—Ä–æ–≤–æ–∫: CL100K_BASE (GPT-3.5/4), P50K_BASE (GPT-3)

### 2. TokenUsage
–ú–æ–¥–µ–ª—å –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ç–æ–∫–µ–Ω–æ–≤.

```kotlin
data class TokenUsage(
    val inputTokens: Int,      // –¢–æ–∫–µ–Ω—ã –≤ –∑–∞–ø—Ä–æ—Å–µ
    val outputTokens: Int,     // –¢–æ–∫–µ–Ω—ã –≤ –æ—Ç–≤–µ—Ç–µ
    val totalTokens: Int       // –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
)
```

### 3. SummarizerAgent
–°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞–≥–µ–Ω—Ç –¥–ª—è —Å–∂–∞—Ç–∏—è –∏—Å—Ç–æ—Ä–∏–∏ –¥–∏–∞–ª–æ–≥–∞.

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- –°–æ–∑–¥–∞—ë—Ç –∫—Ä–∞—Ç–∫–æ–µ —Ä–µ–∑—é–º–µ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –∫–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç
- –£–¥–∞–ª—è–µ—Ç –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è –∏ –Ω–µ—Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –¥–µ—Ç–∞–ª–∏
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–∏–∑–∫—É—é —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É (0.3) –¥–ª—è —Ç–æ—á–Ω–æ—Å—Ç–∏

**–°–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç:**
```
–¢—ã - —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞–≥–µ–Ω—Ç –¥–ª—è —Å–∂–∞—Ç–∏—è –∏—Å—Ç–æ—Ä–∏–∏ –¥–∏–∞–ª–æ–≥–∞.

–¢–≤–æ—è –∑–∞–¥–∞—á–∞:
1. –ü—Ä–æ—á–∏—Ç–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—é –¥–∏–∞–ª–æ–≥–∞ –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –∏ –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–æ–º
2. –°–æ–∑–¥–∞—Ç—å –∫—Ä–∞—Ç–∫–æ–µ, –Ω–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–æ–µ —Ä–µ–∑—é–º–µ –∫–ª—é—á–µ–≤—ã—Ö –º–æ–º–µ–Ω—Ç–æ–≤
3. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤–∞–∂–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏ —Ñ–∞–∫—Ç—ã
4. –£–¥–∞–ª–∏—Ç—å –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è –∏ –Ω–µ—Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –¥–µ—Ç–∞–ª–∏

–§–æ—Ä–º–∞—Ç —Ä–µ–∑—é–º–µ:
- –ò—Å–ø–æ–ª—å–∑—É–π –º–∞—Ä–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ –¥–ª—è –∫–ª—é—á–µ–≤—ã—Ö –º–æ–º–µ–Ω—Ç–æ–≤
- –°–æ—Ö—Ä–∞–Ω—è–π —Ö—Ä–æ–Ω–æ–ª–æ–≥–∏—é –≤–∞–∂–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π
- –í—ã–¥–µ–ª—è–π –Ω–µ—Ä–µ—à—ë–Ω–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ –∑–∞–¥–∞—á–∏
- –ë—É–¥—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –∫—Ä–∞—Ç–∫–∏–º, –Ω–æ –Ω–µ —Ç–µ—Ä—è–π –≤–∞–∂–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
```

### 4. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º –≤ ChatAgent

**–ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç—ã:**

1. **–ü–æ–¥—Å—á—ë—Ç —Ç–æ–∫–µ–Ω–æ–≤ –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π**
   ```kotlin
   val requestTokens = tokenCounter.countRequestTokens(
       systemPrompt, userMessage, conversationHistory
   )
   ```

2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–∞**
   ```kotlin
   if (requestTokens <= settings.maxContextTokens) {
       // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∫–∞–∫ –µ—Å—Ç—å
   }
   ```

3. **–°—Ç—Ä–∞—Ç–µ–≥–∏—è –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏:**

   **–í–∞—Ä–∏–∞–Ω—Ç A: –ê–≤—Ç–æ—Å–∂–∞—Ç–∏–µ –≤–∫–ª—é—á–µ–Ω–æ**
   - –í—ã–∑–æ–≤ `SummarizerAgent` –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ä–µ–∑—é–º–µ
   - –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∂–∞—Ç–æ–π –∏—Å—Ç–æ—Ä–∏–∏: `[—Ä–µ–∑—é–º–µ] + [–ø–æ—Å–ª–µ–¥–Ω–∏–µ 2 —Å–æ–æ–±—â–µ–Ω–∏—è]`
   - –°–∏—Å—Ç–µ–º–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ: "üîÑ –ò—Å—Ç–æ—Ä–∏—è –¥–∏–∞–ª–æ–≥–∞ –±—ã–ª–∞ —Å–∂–∞—Ç–∞ –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ —Ç–æ–∫–µ–Ω–æ–≤"
   - Fallback –Ω–∞ –æ–±—Ä–µ–∑–∫—É –ø—Ä–∏ –æ—à–∏–±–∫–µ —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏–∏

   **–í–∞—Ä–∏–∞–Ω—Ç B: –ê–≤—Ç–æ—Å–∂–∞—Ç–∏–µ –≤—ã–∫–ª—é—á–µ–Ω–æ**
   - –û–±—Ä–µ–∑–∫–∞ —Å—Ç–∞—Ä—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –≤–æ–∑–º–æ–∂–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
   - –°–∏—Å—Ç–µ–º–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ: "‚ö†Ô∏è –ò—Å—Ç–æ—Ä–∏—è –¥–∏–∞–ª–æ–≥–∞ –±—ã–ª–∞ –æ–±—Ä–µ–∑–∞–Ω–∞ –∏–∑-–∑–∞ –ø—Ä–µ–≤—ã—à–µ–Ω–∏—è –ª–∏–º–∏—Ç–∞ —Ç–æ–∫–µ–Ω–æ–≤"

## –ù–∞—Å—Ç—Ä–æ–π–∫–∏

### AgentSettings
```kotlin
data class AgentSettings(
    val maxContextTokens: Int = 8000,           // –õ–∏–º–∏—Ç —Ç–æ–∫–µ–Ω–æ–≤
    val enableAutoSummarization: Boolean = true  // –ê–≤—Ç–æ—Å–∂–∞—Ç–∏–µ
)
```

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è:**
- YandexGPT Lite: 8000 —Ç–æ–∫–µ–Ω–æ–≤
- YandexGPT: 8000 —Ç–æ–∫–µ–Ω–æ–≤
- GPT-3.5: 4096 —Ç–æ–∫–µ–Ω–æ–≤
- GPT-4: 8192 —Ç–æ–∫–µ–Ω–æ–≤

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ö–æ—Ä–æ—Ç–∫–∏–π –∑–∞–ø—Ä–æ—Å (–≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –ª–∏–º–∏—Ç–∞)
```
–ó–∞–ø—Ä–æ—Å: 500 —Ç–æ–∫–µ–Ω–æ–≤
–ò—Å—Ç–æ—Ä–∏—è: 2000 —Ç–æ–∫–µ–Ω–æ–≤
–°–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç: 200 —Ç–æ–∫–µ–Ω–æ–≤
–ò—Ç–æ–≥–æ: 2700 —Ç–æ–∫–µ–Ω–æ–≤ < 8000 ‚úÖ

–î–µ–π—Å—Ç–≤–∏–µ: –û—Ç–ø—Ä–∞–≤–∫–∞ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
```

### –î–ª–∏–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å (–ø—Ä–µ–≤—ã—à–µ–Ω–∏–µ –ª–∏–º–∏—Ç–∞)
```
–ó–∞–ø—Ä–æ—Å: 500 —Ç–æ–∫–µ–Ω–æ–≤
–ò—Å—Ç–æ—Ä–∏—è: 8500 —Ç–æ–∫–µ–Ω–æ–≤
–°–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç: 200 —Ç–æ–∫–µ–Ω–æ–≤
–ò—Ç–æ–≥–æ: 9200 —Ç–æ–∫–µ–Ω–æ–≤ > 8000 ‚ùå

–î–µ–π—Å—Ç–≤–∏–µ: –ê–≤—Ç–æ—Å–∂–∞—Ç–∏–µ –∏—Å—Ç–æ—Ä–∏–∏
–†–µ–∑—É–ª—å—Ç–∞—Ç:
  - –†–µ–∑—é–º–µ: 300 —Ç–æ–∫–µ–Ω–æ–≤
  - –ü–æ—Å–ª–µ–¥–Ω–∏–µ 2 —Å–æ–æ–±—â–µ–Ω–∏—è: 400 —Ç–æ–∫–µ–Ω–æ–≤
  - –ù–æ–≤—ã–π –∏—Ç–æ–≥: 1400 —Ç–æ–∫–µ–Ω–æ–≤ < 8000 ‚úÖ
```

### –ó–∞–ø—Ä–æ—Å, –ø—Ä–µ–≤—ã—à–∞—é—â–∏–π –ª–∏–º–∏—Ç –º–æ–¥–µ–ª–∏
```
–ó–∞–ø—Ä–æ—Å: 500 —Ç–æ–∫–µ–Ω–æ–≤
–ò—Å—Ç–æ—Ä–∏—è: 15000 —Ç–æ–∫–µ–Ω–æ–≤
–°–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç: 200 —Ç–æ–∫–µ–Ω–æ–≤
–ò—Ç–æ–≥–æ: 15700 —Ç–æ–∫–µ–Ω–æ–≤ > 8000 ‚ùå

–î–µ–π—Å—Ç–≤–∏–µ: –ê–≤—Ç–æ—Å–∂–∞—Ç–∏–µ –∏—Å—Ç–æ—Ä–∏–∏
–†–µ–∑—É–ª—å—Ç–∞—Ç:
  - –†–µ–∑—é–º–µ: 400 —Ç–æ–∫–µ–Ω–æ–≤
  - –ü–æ—Å–ª–µ–¥–Ω–∏–µ 2 —Å–æ–æ–±—â–µ–Ω–∏—è: 300 —Ç–æ–∫–µ–Ω–æ–≤
  - –ù–æ–≤—ã–π –∏—Ç–æ–≥: 1400 —Ç–æ–∫–µ–Ω–æ–≤ < 8000 ‚úÖ

–°–∏—Å—Ç–µ–º–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ UI:
"üîÑ –ò—Å—Ç–æ—Ä–∏—è –¥–∏–∞–ª–æ–≥–∞ –±—ã–ª–∞ —Å–∂–∞—Ç–∞ –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ —Ç–æ–∫–µ–Ω–æ–≤ (–±—ã–ª–æ: 15700 —Ç–æ–∫–µ–Ω–æ–≤)"
```

## –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç–∞

–ü–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–∞ –≤ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –¥–æ—Å—Ç—É–ø–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:

```kotlin
val metadata = mapOf(
    "tokenUsage" to TokenUsage(
        inputTokens = 1200,
        outputTokens = 800,
        totalTokens = 2000
    ),
    "provider" to "Yandex",
    "systemMessage" to "üîÑ –ò—Å—Ç–æ—Ä–∏—è –¥–∏–∞–ª–æ–≥–∞ –±—ã–ª–∞ —Å–∂–∞—Ç–∞..." // –µ—Å–ª–∏ –±—ã–ª–æ —Å–∂–∞—Ç–∏–µ
)
```

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –ü–æ–¥—Å—á—ë—Ç —Ç–æ–∫–µ–Ω–æ–≤
- **Tiktoken:** ~0.1-0.5 –º—Å –Ω–∞ 1000 —Å–∏–º–≤–æ–ª–æ–≤
- **Overhead:** –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π, –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç UI

### –°—É–º–º–∞—Ä–∏–∑–∞—Ü–∏—è
- **–í—Ä–µ–º—è:** 2-5 —Å–µ–∫—É–Ω–¥ (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–∞–∑–º–µ—Ä–∞ –∏—Å—Ç–æ—Ä–∏–∏)
- **–¢–æ–∫–µ–Ω—ã:** ~300-1000 —Ç–æ–∫–µ–Ω–æ–≤ –Ω–∞ —Ä–µ–∑—é–º–µ
- **–ß–∞—Å—Ç–æ—Ç–∞:** –¢–æ–ª—å–∫–æ –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞

## –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏:

```
INFO: Request tokens: 9200, max context tokens: 8000
INFO: Token limit exceeded, summarizing history...
INFO: History summarized successfully
INFO: Request successful, tokens used: 2000 (input: 1200, output: 800)
```

## –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

1. **–¢–æ—á–Ω–æ—Å—Ç—å –ø–æ–¥—Å—á—ë—Ç–∞:** Tiktoken –¥–∞—ë—Ç –ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω—É—é –æ—Ü–µ–Ω–∫—É –¥–ª—è Yandex GPT (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è OpenAI)
2. **–ö–∞—á–µ—Å—Ç–≤–æ —Ä–µ–∑—é–º–µ:** –ó–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–∞—á–µ—Å—Ç–≤–∞ —Ä–∞–±–æ—Ç—ã LLM
3. **–ü–æ—Ç–µ—Ä—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞:** –ü—Ä–∏ —Å–∂–∞—Ç–∏–∏ –º–æ–≥—É—Ç —Ç–µ—Ä—è—Ç—å—Å—è –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –¥–µ—Ç–∞–ª–∏
4. **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã:** –°—É–º–º–∞—Ä–∏–∑–∞—Ü–∏—è —Ç—Ä–µ–±—É–µ—Ç –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ API –≤—ã–∑–æ–≤–∞

## –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

- [ ] UI –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —Ç–æ–∫–µ–Ω–æ–≤ –ø–æ–¥ –∫–∞–∂–¥—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º
- [ ] –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ —Å–∂–∞—Ç–∏—è (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ—Ö—Ä–∞–Ω—è–µ–º—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π)
- [ ] –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—é–º–µ –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å API Yandex –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ –ø–æ–¥—Å—á—ë—Ç–∞ —Ç–æ–∫–µ–Ω–æ–≤
- [ ] –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ç–æ–∫–µ–Ω–æ–≤ (—Å–º. [token-usage-tracking.md](./token-usage-tracking.md))

## –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

**–ö–æ–¥:**
- `TokenCounter.kt` - –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å—á—ë—Ç—á–∏–∫–∞
- `TiktokenCounter.kt` - —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ Tiktoken
- `SummarizerAgent.kt` - –∞–≥–µ–Ω—Ç —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏–∏
- `ChatAgent.kt` - –ª–æ–≥–∏–∫–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º
- `LLMResponse.kt` - –º–æ–¥–µ–ª—å —Å TokenUsage
- `AgentSettings.kt` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ª–∏–º–∏—Ç–æ–≤

**–¢–µ—Å—Ç—ã:**
- TODO: –î–æ–±–∞–≤–∏—Ç—å unit-—Ç–µ—Å—Ç—ã –¥–ª—è TokenCounter
- TODO: –î–æ–±–∞–≤–∏—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –¥–ª—è —Å–∂–∞—Ç–∏—è

## Changelog

### v1.0 (2025-10-11)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –ø–æ–¥—Å—á—ë—Ç —Ç–æ–∫–µ–Ω–æ–≤ —á–µ—Ä–µ–∑ Tiktoken
- ‚úÖ –°–æ–∑–¥–∞–Ω SummarizerAgent
- ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–∂–∞—Ç–∏–µ –∏—Å—Ç–æ—Ä–∏–∏
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ª–∏–º–∏—Ç–æ–≤ —Ç–æ–∫–µ–Ω–æ–≤
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç–æ–∫–µ–Ω–æ–≤ –≤ –æ—Ç–≤–µ—Ç–∞—Ö
