# üîå Project Scanner API –¥–ª—è –¥—Ä—É–≥–∏—Ö –∞–≥–µ–Ω—Ç–æ–≤

## üéØ –û–±–∑–æ—Ä

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç API Project Scanner Tool Agent, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–π –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –¥—Ä—É–≥–∏–º–∏ –∞–≥–µ–Ω—Ç–∞–º–∏ –≤ –º—É–ª—å—Ç–∏–∞–≥–µ–Ω—Ç—Å–∫–æ–π —Å–∏—Å—Ç–µ–º–µ. API –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ –ø—Ä–æ–µ–∫—Ç–∞ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è, –ø–æ–¥–ø–∏—Å–æ–∫ –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π.

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   –î—Ä—É–≥–æ–π –∞–≥–µ–Ω—Ç   ‚îÇ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ ProjectScanner   ‚îÇ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ –§–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ ‚îÇ
‚îÇ (Code Analysis)  ‚îÇ    ‚îÇ AgentBridge      ‚îÇ    ‚îÇ –ø—Ä–æ–µ–∫—Ç–∞        ‚îÇ
‚îÇ                  ‚îÇ    ‚îÇ                  ‚îÇ    ‚îÇ                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ                       ‚îÇ                       ‚îÇ
         ‚ñº                       ‚ñº                       ‚ñº
  Business Logic         Convenience API        File Operations
         ‚îÇ                       ‚îÇ                       ‚îÇ
         ‚ñº                       ‚ñº                       ‚ñº
  –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞   –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–∞–º–∏   –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø
```

### –ö–ª—é—á–µ–≤—ã–µ –∫–ª–∞—Å—Å—ã

- **ProjectScannerToolAgent** - –æ—Å–Ω–æ–≤–Ω–æ–π –∞–≥–µ–Ω—Ç —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
- **ProjectScannerAgentBridge** - —É–¥–æ–±–Ω—ã–π API –¥–ª—è –¥—Ä—É–≥–∏—Ö –∞–≥–µ–Ω—Ç–æ–≤
- **DeltaSubscription** - –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤
- **DeltaUpdate** - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ Bridge

```kotlin
import ru.marslab.ide.ride.agent.tools.ProjectScannerAgentBridge

class CodeAnalysisAgent {
    private val scannerBridge = ProjectScannerAgentBridge()

    suspend fun analyzeProject(projectPath: String) {
        // –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
        val scanResult = scannerBridge.scanProject(
            projectPath = projectPath,
            includePatterns = listOf("**/*.kt", "**/*.java"),
            excludePatterns = listOf("build/**", "**/generated/**")
        )

        if (scanResult.success) {
            val files = scanResult.files
            val stats = scanResult.statistics

            // –ê–Ω–∞–ª–∏–∑ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
            analyzeFiles(files)

            // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
            println("–ü—Ä–æ–µ–∫—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç ${stats.languages?.keys} —Ñ–∞–π–ª—ã")
        }
    }
}
```

### –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è

```kotlin
class FileWatcherAgent {
    private val scannerBridge = ProjectScannerAgentBridge()
    private var subscription: AutoCloseable? = null

    fun startWatching(projectPath: String) {
        subscription = scannerBridge.subscribeToFileChanges(
            agentId = "file-watcher",
            projectPath = projectPath
        ) { changedFiles ->
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π
            handleFileChanges(changedFiles)
        }

        println("–ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤ —Å–æ–∑–¥–∞–Ω–∞")
    }

    fun stopWatching() {
        subscription?.close()
        println("–ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤ –æ—Ç–º–µ–Ω–µ–Ω–∞")
    }

    private fun handleFileChanges(changedFiles: List<String>) {
        println("–û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –∏–∑–º–µ–Ω–µ–Ω–∏—è:")
        changedFiles.forEach { file ->
            println(" - $file")
        }

        // –ó–∞–ø—É—Å–∫ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∏–∑–º–µ–Ω–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
        reanalyzeFiles(changedFiles)
    }
}
```

## üìã API Reference

### ProjectScannerAgentBridge

–£–¥–æ–±–Ω—ã–π wrapper –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ—É–Ω–∫—Ü–∏—è–º ProjectScanner –∏–∑ –¥—Ä—É–≥–∏—Ö –∞–≥–µ–Ω—Ç–æ–≤.

#### –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã

##### scanProject()

```kotlin
fun scanProject(
    projectPath: String,
    includePatterns: List<String> = listOf("**/*"),
    excludePatterns: List<String> = emptyList(),
    maxDepth: Int? = null
): ProjectScanResult
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `projectPath`: –ü—É—Ç—å –∫ –ø—Ä–æ–µ–∫—Ç—É
- `includePatterns`: –ü–∞—Ç—Ç–µ—Ä–Ω—ã –≤–∫–ª—é—á–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤ (glob)
- `excludePatterns`: –ü–∞—Ç—Ç–µ—Ä–Ω—ã –∏—Å–∫–ª—é—á–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤ (glob)
- `maxDepth`: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≥–ª—É–±–∏–Ω–∞ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** `ProjectScanResult`

**–ü—Ä–∏–º–µ—Ä:**
```kotlin
val result = scannerBridge.scanProject(
    projectPath = "/home/user/my-project",
    includePatterns = listOf("src/**/*.kt", "src/**/*.java"),
    excludePatterns = listOf("build/**", "**/test/**"),
    maxDepth = 15
)

if (result.success) {
    println("–ù–∞–π–¥–µ–Ω–æ —Ñ–∞–π–ª–æ–≤: ${result.files.size}")
    println("–¢–∏–ø –ø—Ä–æ–µ–∫—Ç–∞: ${result.projectType}")
}
```

##### subscribeToFileChanges()

```kotlin
fun subscribeToFileChanges(
    agentId: String,
    projectPath: String,
    includePatterns: List<String> = listOf("**/*"),
    excludePatterns: List<String> = emptyList(),
    callback: (List<String>) -> Unit
): AutoCloseable
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `agentId`: –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∞–≥–µ–Ω—Ç–∞-–ø–æ–¥–ø–∏—Å—á–∏–∫–∞
- `projectPath`: –ü—É—Ç—å –∫ –ø—Ä–æ–µ–∫—Ç—É –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è
- `includePatterns`: –§–∏–ª—å—Ç—Ä—ã –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤
- `excludePatterns`: –ò—Å–∫–ª—é—á–µ–Ω–∏—è –∏–∑ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è
- `callback`: Callback —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** `AutoCloseable` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ—á–∏—Å—Ç–∫–∏

**–ü—Ä–∏–º–µ—Ä:**
```kotlin
val subscription = scannerBridge.subscribeToFileChanges(
    agentId = "code-analyzer",
    projectPath = "/home/user/project",
    includePatterns = listOf("src/**/*.kt"),
    excludePatterns = listOf("**/generated/**")
) { changedFiles ->
    // –ü–µ—Ä–µ—Å–±–æ—Ä –∏–Ω–¥–µ–∫—Å–∞ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö
    rebuildIndex(changedFiles)
}

// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Ç–ø–∏—Å–∫–∞ –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ –∏–∑ scope
use(subscription) {
    // –†–∞–±–æ—Ç–∞ —Å –ø–æ–¥–ø–∏—Å–∫–æ–π
}
```

##### getDeltaChanges()

```kotlin
suspend fun getDeltaChanges(
    projectPath: String,
    sinceTimestamp: Long,
    includePatterns: List<String> = listOf("**/*"),
    excludePatterns: List<String> = emptyList()
): List<String>
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `projectPath`: –ü—É—Ç—å –∫ –ø—Ä–æ–µ–∫—Ç—É
- `sinceTimestamp`: –í—Ä–µ–º–µ–Ω–Ω–∞—è –º–µ—Ç–∫–∞ –¥–ª—è –ø–æ–∏—Å–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- `includePatterns`: –§–∏–ª—å—Ç—Ä—ã —Ñ–∞–π–ª–æ–≤
- `excludePatterns`: –ò—Å–∫–ª—é—á–µ–Ω–∏—è

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** –°–ø–∏—Å–æ–∫ –∏–∑–º–µ–Ω–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤

**–ü—Ä–∏–º–µ—Ä:**
```kotlin
val oneHourAgo = System.currentTimeMillis() - (60 * 60 * 1000)
val changedFiles = scannerBridge.getDeltaChanges(
    projectPath = "/home/user/project",
    sinceTimestamp = oneHourAgo,
    includePatterns = listOf("src/**/*.kt")
)

println("–§–∞–π–ª—ã, –∏–∑–º–µ–Ω–µ–Ω–Ω—ã–µ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π —á–∞—Å:")
changedFiles.forEach { file ->
    println(" - $file")
}
```

### ProjectScanResult

–†–µ–∑—É–ª—å—Ç–∞—Ç —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞.

```kotlin
data class ProjectScanResult(
    val success: Boolean,
    val files: List<String>,
    val directories: List<String>,
    val projectType: String,
    val statistics: ProjectStatistics?,
    val error: String? = null,
    val performanceMetrics: PerformanceMetrics?
)
```

**–ü–æ–ª—è:**
- `success`: –£—Å–ø–µ—à–Ω–æ—Å—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- `files`: –°–ø–∏—Å–æ–∫ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
- `directories`: –°–ø–∏—Å–æ–∫ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π
- `projectType`: –¢–∏–ø –ø—Ä–æ–µ–∫—Ç–∞ (GRADLE_KOTLIN, MAVEN, –∏ —Ç.–¥.)
- `statistics`: –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –ø—Ä–æ–µ–∫—Ç—É
- `error`: –û—à–∏–±–∫–∞, –µ—Å–ª–∏ –Ω–µ—É—Å–ø–µ—à–Ω–æ
- `performanceMetrics`: –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### ProjectStatistics

–°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ–µ–∫—Ç–µ.

```kotlin
data class ProjectStatistics(
    val totalFiles: Int,
    val totalLines: Int,
    val languages: Map<String, Int>,
    val fileAnalysis: FileAnalysis,
    val dependencies: DependencyInfo?
)
```

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
```kotlin
val stats = result.statistics
if (stats != null) {
    println("–í—Å–µ–≥–æ —Ñ–∞–π–ª–æ–≤: ${stats.totalFiles}")
    println("–í—Å–µ–≥–æ —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞: ${stats.totalLines}")

    println("–Ø–∑—ã–∫–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è:")
    stats.languages.forEach { (language, count) ->
        println("  $language: $count —Ñ–∞–π–ª–æ–≤")
    }

    println("–ê–Ω–∞–ª–∏–∑ —Ä–∞–∑–º–µ—Ä–æ–≤ —Ñ–∞–π–ª–æ–≤:")
    println("  –ú–∞–ª–µ–Ω—å–∫–∏–µ (<1KB): ${stats.fileAnalysis.smallFiles}")
    println("  –°—Ä–µ–¥–Ω–∏–µ (1-10KB): ${stats.fileAnalysis.mediumFiles}")
    println("  –ë–æ–ª—å—à–∏–µ (>10KB): ${stats.fileAnalysis.largeFiles}")
}
```

## üîí –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–∞–º–∏

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞

```kotlin
class MyAgent {
    private val scannerBridge = ProjectScannerAgentBridge()

    suspend fun processProject(projectPath: String) {
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–æ–¥–ø–∏—Å–∫–∞ —Å –æ—á–∏—Å—Ç–∫–æ–π
        use(scannerBridge.subscribeToFileChanges("my-agent", projectPath) { files ->
            processChanges(files)
        }) {
            // –†–∞–±–æ—Ç–∞ —Å –ø–æ–¥–ø–∏—Å–∫–æ–π
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø–∏—Å–∞—Ç—å—Å—è –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ –∏–∑ use-–±–ª–æ–∫–∞
        }
    }
}
```

### –†—É—á–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–∞–º–∏

```kotlin
class AnotherAgent {
    private val scannerBridge = ProjectScannerAgentBridge()
    private val subscriptions = mutableListOf<AutoCloseable>()

    fun startWatching(paths: List<String>) {
        paths.forEach { path ->
            val subscription = scannerBridge.subscribeToFileChanges(
                agentId = "another-agent",
                projectPath = path
            ) { files ->
                handleChanges(files)
            }
            subscriptions.add(subscription)
        }
    }

    fun stopWatching() {
        subscriptions.forEach { it.close() }
        subscriptions.clear()
    }
}
```

## üîÑ –®–∞–±–ª–æ–Ω—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

### 1. Code Analysis Agent

```kotlin
class CodeAnalysisAgent {
    private val scannerBridge = ProjectScannerAgentBridge()
    private var fileIndex: Map<String, FileInfo> = emptyMap()

    suspend fun analyzeProject(projectPath: String) {
        // –ù–∞—á–∞–ª—å–Ω–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
        val scanResult = scannerBridge.scanProject(
            projectPath = projectPath,
            includePatterns = listOf("src/**/*.kt", "src/**/*.java")
        )

        if (scanResult.success) {
            // –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–∞
            buildIndex(scanResult.files)

            // –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è
            scannerBridge.subscribeToFileChanges(
                agentId = "code-analyzer",
                projectPath = projectPath,
                includePatterns = listOf("src/**/*.kt", "src/**/*.java")
            ) { changedFiles ->
                updateIndex(changedFiles)
                runAnalysis(changedFiles)
            }
        }
    }

    private fun buildIndex(files: List<String>) {
        fileIndex = files.associateWith { path ->
            FileInfo(path = path, lastAnalyzed = 0L, metrics = null)
        }
    }

    private fun updateIndex(changedFiles: List<String>) {
        changedFiles.forEach { file ->
            fileIndex = fileIndex + (file to FileInfo(
                path = file,
                lastAnalyzed = System.currentTimeMillis(),
                metrics = null
            ))
        }
    }

    private suspend fun runAnalysis(files: List<String>) {
        // –ó–∞–ø—É—Å–∫ –∞–Ω–∞–ª–∏–∑–∞ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
        files.forEach { file ->
            analyzeFile(file)
        }
    }

    private fun analyzeFile(filePath: String) {
        // –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∞–Ω–∞–ª–∏–∑–∞ —Ñ–∞–π–ª–∞
        println("–ê–Ω–∞–ª–∏–∑ —Ñ–∞–π–ª–∞: $filePath")
    }
}

data class FileInfo(
    val path: String,
    val lastAnalyzed: Long,
    val metrics: FileMetrics?
)

data class FileMetrics(
    val lines: Int,
    val complexity: Int,
    val dependencies: List<String>
)
```

### 2. Documentation Agent

```kotlin
class DocumentationAgent {
    private val scannerBridge = ProjectScannerAgentBridge()

    suspend fun generateDocumentation(projectPath: String) {
        // –ü–æ–∏—Å–∫ —Ñ–∞–π–ª–æ–≤ —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π
        val docResult = scannerBridge.scanProject(
            projectPath = projectPath,
            includePatterns = listOf(
                "**/*.md",
                "**/*.rst",
                "README*",
                "src/**/*.kt", // –î–ª—è –∞–Ω–∞–ª–∏–∑–∞ docstrings
                "src/**/*.java"
            )
        )

        if (docResult.success) {
            // –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤
            val (docFiles, sourceFiles) = docResult.files.partition {
                it.endsWith(".md") || it.endsWith(".rst") || it.startsWith("README")
            }

            // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
            generateApiDocumentation(sourceFiles)
            processMarkdownFiles(docFiles)
        }
    }

    private fun generateApiDocumentation(sourceFiles: List<String>) {
        sourceFiles.forEach { file ->
            if (file.endsWith(".kt") || file.endsWith(".java")) {
                extractDocStrings(file)
            }
        }
    }

    private fun extractDocStrings(filePath: String) {
        // –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –∏–∑ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∫–æ–¥–∞
        println("–ê–Ω–∞–ª–∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –≤: $filePath")
    }

    private fun processMarkdownFiles(docFiles: List<String>) {
        docFiles.forEach { file ->
            println("–û–±—Ä–∞–±–æ—Ç–∫–∞ Markdown —Ñ–∞–π–ª–∞: $file")
        }
    }
}
```

### 3. Security Analysis Agent

```kotlin
class SecurityAnalysisAgent {
    private val scannerBridge = ProjectScannerAgentBridge()

    suspend fun performSecurityAnalysis(projectPath: String) {
        // –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
        val configResult = scannerBridge.scanProject(
            projectPath = projectPath,
            includePatterns = listOf(
                "*.properties",
                "*.yml",
                "*.yaml",
                "*.json",
                "*.gradle*",
                "pom.xml"
            )
        )

        // –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∫–æ–¥–∞
        val sourceResult = scannerBridge.scanProject(
            projectPath = projectPath,
            includePatterns = listOf(
                "src/**/*.kt",
                "src/**/*.java",
                "src/**/*.js",
                "src/**/*.ts"
            ),
            excludePatterns = listOf("**/test/**")
        )

        if (configResult.success && sourceResult.success) {
            analyzeConfigurations(configResult.files)
            analyzeSourceCode(sourceResult.files)
        }

        // –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–ª—è –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
        startContinuousMonitoring(projectPath)
    }

    private fun analyzeConfigurations(configFiles: List<String>) {
        configFiles.forEach { file ->
            when {
                file.endsWith(".properties") -> analyzePropertiesFile(file)
                file.endsWith(".yml") || file.endsWith(".yaml") -> analyzeYamlFile(file)
                file.contains("gradle") -> analyzeGradleFile(file)
            }
        }
    }

    private fun analyzeSourceCode(sourceFiles: List<String>) {
        sourceFiles.forEach { file ->
            // –ü–æ–∏—Å–∫ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π
            scanForVulnerabilities(file)
        }
    }

    private fun startContinuousMonitoring(projectPath: String) {
        scannerBridge.subscribeToFileChanges(
            agentId = "security-analyzer",
            projectPath = projectPath,
            includePatterns = listOf(
                "src/**/*",
                "*.properties",
                "*.yml",
                "*.yaml"
            )
        ) { changedFiles ->
            // –ü–æ–≤—Ç–æ—Ä–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∏–∑–º–µ–Ω–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
            changedFiles.forEach { file ->
                when {
                    file.endsWith(".properties") -> analyzePropertiesFile(file)
                    file.endsWith(".yml") || file.endsWith(".yaml") -> analyzeYamlFile(file)
                    file.contains("src/") -> scanForVulnerabilities(file)
                }
            }
        }
    }

    private fun analyzePropertiesFile(filePath: String) {
        // –ê–Ω–∞–ª–∏–∑ security –Ω–∞—Å—Ç—Ä–æ–µ–∫ –≤ properties —Ñ–∞–π–ª–∞—Ö
    }

    private fun analyzeYamlFile(filePath: String) {
        // –ê–Ω–∞–ª–∏–∑ security –Ω–∞—Å—Ç—Ä–æ–µ–∫ –≤ YAML —Ñ–∞–π–ª–∞—Ö
    }

    private fun analyzeGradleFile(filePath: String) {
        // –ê–Ω–∞–ª–∏–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –∏ security –Ω–∞—Å—Ç—Ä–æ–µ–∫ Gradle
    }

    private fun scanForVulnerabilities(filePath: String) {
        // –ü–æ–∏—Å–∫ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π –≤ –∏—Å—Ö–æ–¥–Ω–æ–º –∫–æ–¥–µ
    }
}
```

## ‚ö° –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### 1. –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

```kotlin
class OptimizedAgent {
    private val scannerBridge = ProjectScannerAgentBridge()
    private val scanCache = mutableMapOf<String, ProjectScanResult>()

    suspend fun getProjectFiles(projectPath: String): List<String> {
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫—ç—à–∞
        val cached = scanCache[projectPath]
        if (cached != null && isCacheValid(cached)) {
            return cached.files
        }

        // –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –≤ –∫—ç—à–µ
        val result = scannerBridge.scanProject(
            projectPath = projectPath,
            includePatterns = listOf("src/**/*.kt", "src/**/*.java")
        )

        if (result.success) {
            scanCache[projectPath] = result
        }

        return result.files
    }

    private fun isCacheValid(result: ProjectScanResult): Boolean {
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏ –∫—ç—à–∞
        return (System.currentTimeMillis() - result.timestamp) < 5 * 60 * 1000 // 5 –º–∏–Ω—É—Ç
    }
}
```

### 2. –ü–∞–∫–µ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞

```kotlin
class BatchProcessingAgent {
    private val scannerBridge = ProjectScannerAgentBridge()

    suspend fun processLargeProject(projectPath: String) {
        val batchSize = 200
        var currentPage = 1
        var hasMore = true

        while (hasMore) {
            // –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ ProjectScanner –¥–ª—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
            val scanStep = ToolPlanStep(
                description = "–ü–∞–∫–µ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞",
                agentType = AgentType.PROJECT_SCANNER,
                input = StepInput.empty()
                    .set("project_path", projectPath)
                    .set("include_patterns", listOf("src/**/*.kt", "src/**/*.java"))
                    .set("page", currentPage)
                    .set("batch_size", batchSize)
            )

            val result = scannerAgent.executeStep(scanStep, context)
            val json = result.output.get<Map<String, Any>>("json")
            val files = json?.get("files") as? List<String>
            val batch = json?.get("batch") as? Map<String, Any>

            files?.let { processBatch(it) }
            hasMore = batch?.get("has_more") as? Boolean ?: false
            currentPage++
        }
    }

    private fun processBatch(files: List<String>) {
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–∞–∫–µ—Ç–∞ —Ñ–∞–π–ª–æ–≤
        files.forEach { file ->
            processFile(file)
        }
    }

    private fun processFile(filePath: String) {
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
    }
}
```

## üö® –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### –ë–∞–∑–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

```kotlin
class RobustAgent {
    private val scannerBridge = ProjectScannerAgentBridge()

    suspend fun safeScanProject(projectPath: String): ProjectScanResult? {
        return try {
            val result = scannerBridge.scanProject(
                projectPath = projectPath,
                includePatterns = listOf("src/**/*.kt", "src/**/*.java")
            )

            if (!result.success) {
                logger.error("–û—à–∏–±–∫–∞ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è: ${result.error}")
                // –ü–æ–ø—ã—Ç–∫–∞ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Å –±–æ–ª–µ–µ –º—è–≥–∫–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
                retryWithFallbackParameters(projectPath)
            } else {
                result
            }
        } catch (e: Exception) {
            logger.error("–ò—Å–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–∏ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏: ${e.message}")
            null
        }
    }

    private suspend fun retryWithFallbackParameters(projectPath: String): ProjectScanResult? {
        return try {
            scannerBridge.scanProject(
                projectPath = projectPath,
                includePatterns = listOf("src/**/*.kt"), // –¢–æ–ª—å–∫–æ Kotlin —Ñ–∞–π–ª—ã
                maxDepth = 10 // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è –≥–ª—É–±–∏–Ω–∞
            )
        } catch (e: Exception) {
            logger.error("–ü–æ–≤—Ç–æ—Ä–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞ –Ω–µ —É–¥–∞–ª–∞—Å—å: ${e.message}")
            null
        }
    }
}
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –ø–æ–¥–ø–∏—Å–æ–∫

```kotlin
class SubscriptionAgent {
    private val scannerBridge = ProjectScannerAgentBridge()

    fun createRobustSubscription(projectPath: String) {
        try {
            val subscription = scannerBridge.subscribeToFileChanges(
                agentId = "robust-agent",
                projectPath = projectPath,
                includePatterns = listOf("src/**/*.kt", "src/**/*.java")
            ) { changedFiles ->
                try {
                    processChangedFiles(changedFiles)
                } catch (e: Exception) {
                    logger.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π: ${e.message}")
                }
            }

            // –•—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∏ –¥–ª—è –æ—á–∏—Å—Ç–∫–∏
            subscriptions.add(subscription)

        } catch (e: Exception) {
            logger.error("–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –ø–æ–¥–ø–∏—Å–∫—É: ${e.message}")
            // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞
            startPolling(projectPath)
        }
    }

    private fun startPolling(projectPath: String) {
        // Fallback –∫ –æ–ø—Ä–æ—Å—É –∏–∑–º–µ–Ω–µ–Ω–∏–π
        timer.scheduleAtFixedRate(object : TimerTask() {
            override fun run() {
                checkForChanges(projectPath)
            }
        }, 0, 30 * 1000) // –ö–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
    }
}
```

## üìä –ú–µ—Ç—Ä–∏–∫–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

```kotlin
class MonitoredAgent {
    private val scannerBridge = ProjectScannerAgentBridge()

    suspend fun scanWithMetrics(projectPath: String): ProjectScanResult? {
        val startTime = System.currentTimeMillis()

        val result = scannerBridge.scanProject(
            projectPath = projectPath,
            includePatterns = listOf("src/**/*.kt", "src/**/*.java")
        )

        val duration = System.currentTimeMillis() - startTime

        if (result.success) {
            // –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ—Ç—Ä–∏–∫
            logger.info("–°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ –∑–∞ ${duration}ms")
            logger.info("–ù–∞–π–¥–µ–Ω–æ —Ñ–∞–π–ª–æ–≤: ${result.files.size}")

            result.performanceMetrics?.let { metrics ->
                logger.info("Hit rate –∫—ç—à–∞: ${metrics.cacheHitRate}")
                logger.info("–°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –Ω–∞ —Ñ–∞–π–ª: ${metrics.avgTimePerFileUs}Œºs")
            }
        }

        return result
    }
}
```

## üîó –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –ø–ª–∞–Ω–∞—Ö –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏

```kotlin
class OrchestratorIntegrationAgent {
    private val scannerBridge = ProjectScannerAgentBridge()

    suspend fun executeWithOrchestrator(projectPath: String) {
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º
        val scanStep = ToolPlanStep(
            description = "–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∞–Ω–∞–ª–∏–∑–∞ –ø—Ä–æ–µ–∫—Ç–∞",
            agentType = AgentType.PROJECT_SCANNER,
            input = StepInput.empty()
                .set("project_path", projectPath)
                .set("include_patterns", listOf("src/**/*.kt", "src/**/*.java"))
        )

        // –û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—Å—Ç –ø–æ–¥–ø–∏—Å–∫—É –¥–ª—è –¥–æ–ª–≥–∏—Ö –ø–ª–∞–Ω–æ–≤
        val context = ExecutionContext(projectPath = projectPath)
        val result = scannerAgent.executeStep(scanStep, context)

        // –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –±—É–¥—É—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–∫—ç—à–∏—Ä–æ–≤–∞–Ω—ã –¥–ª—è —Å–ª–µ–¥—É—é—â–∏—Ö —à–∞–≥–æ–≤
    }
}
```

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é](../guides/project-scanner-usage-guide.md)
- [–ü—Ä–∏–º–µ—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏](../guides/project-scanner-configuration-examples.md)
- [Roadmap Project Scanner](../roadmaps/16-enhanced-project-scanner.md)

---

<p align="center">
  <sub>API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞: 2025-10-25</sub>
</p>