# ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° Ğ¿Ğ»Ğ°Ğ³Ğ¸Ğ½Ğ° Ride - ĞšÑ€Ğ°Ñ‚ĞºĞ¾Ğµ Ñ€ĞµĞ·ÑĞ¼Ğµ

## ğŸ¯ ĞÑĞ½Ğ¾Ğ²Ğ½Ğ°Ñ ĞºĞ¾Ğ½Ñ†ĞµĞ¿Ñ†Ğ¸Ñ

ĞŸĞ»Ğ°Ğ³Ğ¸Ğ½ Ğ´Ğ»Ñ IntelliJ IDEA Ñ AI-Ñ‡Ğ°Ñ‚Ğ¾Ğ¼, Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒÑÑ‰Ğ¸Ğ¼ Yandex GPT (Ñ Ğ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚ÑŒÑ Ñ€Ğ°ÑÑˆĞ¸Ñ€ĞµĞ½Ğ¸Ñ Ğ½Ğ° Ğ´Ñ€ÑƒĞ³Ğ¸Ğµ LLM).

## ğŸ—ï¸ ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ½Ñ‹Ğµ ÑĞ»Ğ¾Ğ¸

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         UI Layer                    â”‚  â† ChatPanel, ChatToolWindow
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         Service Layer               â”‚  â† ChatService, MessageHistory
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         Agent Layer                 â”‚  â† Agent (interface), ChatAgent
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         Integration Layer           â”‚  â† LLMProvider (interface), YandexGPTProvider
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         Configuration Layer         â”‚  â† PluginSettings, SettingsConfigurable
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## âœ¨ ĞšĞ»ÑÑ‡ĞµĞ²Ğ¾Ğµ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ½Ğ¾Ğµ Ñ€ĞµÑˆĞµĞ½Ğ¸Ğµ

### Agent ĞĞ• Ğ¿Ñ€Ğ¸Ğ²ÑĞ·Ğ°Ğ½ Ğº ĞºĞ¾Ğ½ĞºÑ€ĞµÑ‚Ğ½Ğ¾Ğ¼Ñƒ LLM Ğ¿Ñ€Ğ¾Ğ²Ğ°Ğ¹Ğ´ĞµÑ€Ñƒ!

**Ğ‘Ñ‹Ğ»Ğ¾ (Ğ½ĞµĞ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾):**
```
YandexGPTAgent â†’ Ğ½Ğ°Ğ¿Ñ€ÑĞ¼ÑƒÑ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ Yandex GPT API
```

**Ğ¡Ñ‚Ğ°Ğ»Ğ¾ (Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾):**
```
ChatAgent â†’ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ LLMProvider (interface) â†’ YandexGPTProvider
                                                â†’ OpenAIProvider
                                                â†’ Ğ»ÑĞ±Ğ¾Ğ¹ Ğ´Ñ€ÑƒĞ³Ğ¾Ğ¹ Ğ¿Ñ€Ğ¾Ğ²Ğ°Ğ¹Ğ´ĞµÑ€
```

### ĞŸĞ¾Ñ‡ĞµĞ¼Ñƒ ÑÑ‚Ğ¾ Ğ²Ğ°Ğ¶Ğ½Ğ¾?

1. **Ğ“Ğ¸Ğ±ĞºĞ¾ÑÑ‚ÑŒ**: ĞœĞ¾Ğ¶Ğ½Ğ¾ Ğ»ĞµĞ³ĞºĞ¾ Ğ¿ĞµÑ€ĞµĞºĞ»ÑÑ‡Ğ°Ñ‚ÑŒÑÑ Ğ¼ĞµĞ¶Ğ´Ñƒ LLM Ğ¿Ñ€Ğ¾Ğ²Ğ°Ğ¹Ğ´ĞµÑ€Ğ°Ğ¼Ğ¸
2. **Ğ Ğ°ÑÑˆĞ¸Ñ€ÑĞµĞ¼Ğ¾ÑÑ‚ÑŒ**: Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ½Ğ¾Ğ²Ğ¾Ğ³Ğ¾ Ğ¿Ñ€Ğ¾Ğ²Ğ°Ğ¹Ğ´ĞµÑ€Ğ° Ğ½Ğµ Ñ‚Ñ€ĞµĞ±ÑƒĞµÑ‚ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ Ğ°Ğ³ĞµĞ½Ñ‚Ğ°
3. **Ğ¢ĞµÑÑ‚Ğ¸Ñ€ÑƒĞµĞ¼Ğ¾ÑÑ‚ÑŒ**: Ğ›ĞµĞ³ĞºĞ¾ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ mock Ğ¿Ñ€Ğ¾Ğ²Ğ°Ğ¹Ğ´ĞµÑ€ Ğ´Ğ»Ñ Ñ‚ĞµÑÑ‚Ğ¾Ğ²
4. **SOLID Ğ¿Ñ€Ğ¸Ğ½Ñ†Ğ¸Ğ¿Ñ‹**: Dependency Inversion, Single Responsibility

## ğŸ“¦ ĞÑĞ½Ğ¾Ğ²Ğ½Ñ‹Ğµ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹

### Agent Layer

**Agent (interface)**
```kotlin
interface Agent {
    suspend fun processRequest(request: String, context: ChatContext): AgentResponse
    fun getName(): String
    fun getDescription(): String
}
```

**ChatAgent (implementation)**
- Ğ£Ğ½Ğ¸Ğ²ĞµÑ€ÑĞ°Ğ»ÑŒĞ½Ğ°Ñ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ´Ğ»Ñ Ñ‡Ğ°Ñ‚Ğ°
- ĞŸĞ¾Ğ»ÑƒÑ‡Ğ°ĞµÑ‚ `LLMProvider` Ñ‡ĞµÑ€ĞµĞ· ĞºĞ¾Ğ½ÑÑ‚Ñ€ÑƒĞºÑ‚Ğ¾Ñ€ (DI)
- Ğ¤Ğ¾Ñ€Ğ¼Ğ¸Ñ€ÑƒĞµÑ‚ Ğ¿Ñ€Ğ¾Ğ¼Ğ¿Ñ‚Ñ‹ Ñ ÑƒÑ‡ĞµÑ‚Ğ¾Ğ¼ ĞºĞ¾Ğ½Ñ‚ĞµĞºÑÑ‚Ğ°
- Ğ”ĞµĞ»ĞµĞ³Ğ¸Ñ€ÑƒĞµÑ‚ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹ Ğ² Ğ¿Ñ€Ğ¾Ğ²Ğ°Ğ¹Ğ´ĞµÑ€

### Integration Layer

**LLMProvider (interface)**
```kotlin
interface LLMProvider {
    suspend fun sendRequest(prompt: String, parameters: LLMParameters): LLMResponse
    fun isAvailable(): Boolean
    fun getProviderName(): String
}
```

**YandexGPTProvider (implementation)**
- HTTP ĞºĞ»Ğ¸ĞµĞ½Ñ‚ Ğ´Ğ»Ñ Yandex GPT API
- ĞÑƒÑ‚ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ñ Ñ‡ĞµÑ€ĞµĞ· API ĞºĞ»ÑÑ‡
- Retry Ğ»Ğ¾Ğ³Ğ¸ĞºĞ° Ğ¸ rate limiting

## ğŸ”„ ĞŸĞ¾Ñ‚Ğ¾Ğº Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

```
ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ Ğ²Ğ²Ğ¾Ğ´Ğ¸Ñ‚ Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ
    â†“
ChatPanel
    â†“
ChatService
    â†“
ChatAgent.processRequest()
    â†“
ChatAgent.buildPrompt() (Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ÑĞµÑ‚ ĞºĞ¾Ğ½Ñ‚ĞµĞºÑÑ‚)
    â†“
LLMProvider.sendRequest() (Yandex GPT Ğ¸Ğ»Ğ¸ Ğ´Ñ€ÑƒĞ³Ğ¾Ğ¹)
    â†“
ĞÑ‚Ğ²ĞµÑ‚ Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ÑÑ Ñ‡ĞµÑ€ĞµĞ· Ñ‚Ğµ Ğ¶Ğµ ÑĞ»Ğ¾Ğ¸
    â†“
ĞÑ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶Ğ°ĞµÑ‚ÑÑ Ğ² ChatPanel
```

## ğŸš€ Ğ¢Ğ¾Ñ‡ĞºĞ¸ Ñ€Ğ°ÑÑˆĞ¸Ñ€ĞµĞ½Ğ¸Ñ

### 1. ĞĞ¾Ğ²Ñ‹Ğ¹ LLM Ğ¿Ñ€Ğ¾Ğ²Ğ°Ğ¹Ğ´ĞµÑ€
```kotlin
class OpenAIProvider : LLMProvider {
    override suspend fun sendRequest(prompt: String, parameters: LLMParameters): LLMResponse {
        // Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Ñ OpenAI API
    }
}
```

### 2. ĞĞ¾Ğ²Ñ‹Ğ¹ Ñ‚Ğ¸Ğ¿ Ğ°Ğ³ĞµĞ½Ñ‚Ğ°
```kotlin
class CodeAnalysisAgent(private val llmProvider: LLMProvider) : Agent {
    override suspend fun processRequest(request: String, context: ChatContext): AgentResponse {
        // Ğ¡Ğ¿ĞµÑ†Ğ¸Ñ„Ğ¸Ñ‡Ğ½Ğ°Ñ Ğ»Ğ¾Ğ³Ğ¸ĞºĞ° Ğ´Ğ»Ñ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ° ĞºĞ¾Ğ´Ğ°
        val enhancedPrompt = buildCodeAnalysisPrompt(request, context)
        return llmProvider.sendRequest(enhancedPrompt, params)
    }
}
```

### 3. ĞĞ¾Ğ²Ñ‹Ğµ Ñ„Ğ¸Ñ‡Ğ¸
- RAG Ğ´Ğ»Ñ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹ Ñ ĞºĞ¾Ğ´Ğ¾Ğ²Ğ¾Ğ¹ Ğ±Ğ°Ğ·Ğ¾Ğ¹
- Ğ˜Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚Ñ‹ (tools) Ğ´Ğ»Ñ Ğ°Ğ³ĞµĞ½Ñ‚Ğ°
- Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Ñ IDE (Ñ€ĞµÑ„Ğ°ĞºÑ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³, Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·)
- Streaming Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ¾Ğ²
- Ğ˜ÑÑ‚Ğ¾Ñ€Ğ¸Ñ ÑĞµÑÑĞ¸Ğ¹

## ğŸ“ Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ²

```
src/main/kotlin/ru/marslab/ide/ride/
â”œâ”€â”€ agent/
â”‚   â”œâ”€â”€ Agent.kt                    # Ğ˜Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹Ñ
â”‚   â”œâ”€â”€ AgentFactory.kt             # Ğ¤Ğ°Ğ±Ñ€Ğ¸ĞºĞ°
â”‚   â””â”€â”€ impl/
â”‚       â””â”€â”€ ChatAgent.kt            # Ğ£Ğ½Ğ¸Ğ²ĞµÑ€ÑĞ°Ğ»ÑŒĞ½Ğ°Ñ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ
â”œâ”€â”€ integration/llm/
â”‚   â”œâ”€â”€ LLMProvider.kt              # Ğ˜Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹Ñ
â”‚   â”œâ”€â”€ LLMProviderFactory.kt       # Ğ¤Ğ°Ğ±Ñ€Ğ¸ĞºĞ°
â”‚   â””â”€â”€ impl/
â”‚       â””â”€â”€ YandexGPTProvider.kt    # Yandex GPT
â”œâ”€â”€ model/
â”‚   â”œâ”€â”€ Message.kt
â”‚   â”œâ”€â”€ ChatContext.kt
â”‚   â”œâ”€â”€ AgentResponse.kt
â”‚   â””â”€â”€ LLMParameters.kt
â”œâ”€â”€ service/
â”‚   â”œâ”€â”€ ChatService.kt
â”‚   â””â”€â”€ MessageHistory.kt
â”œâ”€â”€ settings/
â”‚   â”œâ”€â”€ PluginSettings.kt
â”‚   â””â”€â”€ SettingsConfigurable.kt
â””â”€â”€ ui/
    â”œâ”€â”€ ChatToolWindowFactory.kt
    â”œâ”€â”€ ChatPanel.kt
    â””â”€â”€ components/
```

## ğŸ”’ Ğ‘ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚ÑŒ

- API ĞºĞ»ÑÑ‡Ğ¸ Ñ…Ñ€Ğ°Ğ½ÑÑ‚ÑÑ Ğ² `PasswordSafe` (IntelliJ Platform)
- ĞĞ¸ĞºĞ¾Ğ³Ğ´Ğ° Ğ½Ğµ Ğ»Ğ¾Ğ³Ğ¸Ñ€ÑƒÑÑ‚ÑÑ Ñ‡ÑƒĞ²ÑÑ‚Ğ²Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ
- Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ Ğ²ÑĞµÑ… Ğ²Ñ…Ğ¾Ğ´Ğ½Ñ‹Ñ… Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

## ğŸ“š Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ

- **architecture.md** - ĞŸĞ¾Ğ»Ğ½Ğ°Ñ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°
- **project-structure.md** - Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°
- **api-integration.md** - Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Ñ Yandex GPT API
- **sequence-diagrams.md** - Ğ”Ğ¸Ğ°Ğ³Ñ€Ğ°Ğ¼Ğ¼Ñ‹ Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸
- **chat-agent-example.md** - ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸ ChatAgent
- **ARCHITECTURE_SUMMARY.md** - Ğ­Ñ‚Ğ¾Ñ‚ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚

## âš¡ Ğ¢ĞµÑ…Ğ½Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ ÑÑ‚ĞµĞº

- **Kotlin** 2.1.0
- **IntelliJ Platform** 2025.1.4.1
- **Kotlin Coroutines** Ğ´Ğ»Ñ Ğ°ÑĞ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ğ½Ğ¾ÑÑ‚Ğ¸
- **Ktor Client** Ğ´Ğ»Ñ HTTP Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ²
- **kotlinx.serialization** Ğ´Ğ»Ñ JSON

## ğŸ¯ Ğ¡Ğ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğµ ÑˆĞ°Ğ³Ğ¸

1. âœ… ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ğ½Ğ° Ğ¸ ÑƒÑ‚Ğ²ĞµÑ€Ğ¶Ğ´ĞµĞ½Ğ°
2. â³ Ğ ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ±Ğ°Ğ·Ğ¾Ğ²Ğ¾Ğ¹ Ğ¸Ğ½Ñ„Ñ€Ğ°ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ñ‹ (Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹ÑÑ‹, Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸)
3. â³ Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Ñ Yandex GPT
4. â³ UI Ğ¸ Ğ¿Ğ¾Ğ»Ğ½Ğ¾Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ñ‡Ğ°Ñ‚
5. â³ Ğ Ğ°ÑÑˆĞ¸Ñ€ĞµĞ½Ğ½Ñ‹Ğµ Ğ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚Ğ¸

---

**Ğ”Ğ°Ñ‚Ğ° ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ:** 2025-10-01  
**Ğ’ĞµÑ€ÑĞ¸Ñ:** 1.0  
**Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ:** Ğ“Ğ¾Ñ‚Ğ¾Ğ²Ğ¾ Ğº Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸
